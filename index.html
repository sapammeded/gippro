<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GIP V5 ¬∑ HYBRID SCALP ENGINE</title>

<style>
body{margin:0;font-family:Arial;background:#0b0f18;color:#fff;padding:15px;}
.card{background:#141a2a;border:1px solid #1f2940;border-radius:12px;padding:15px;margin-bottom:15px;}
h2{margin-top:0;color:#00eaff;}
input{width:100%;padding:8px;margin:4px 0;background:#000;border:1px solid #00eaff;color:#0ff;border-radius:6px;}
button{width:100%;padding:10px;margin-top:6px;border-radius:6px;font-weight:bold;background:#101828;border:1px solid #00eaff;color:#0ff;cursor:pointer;}
.status{padding:8px;margin:5px 0;border-radius:6px;text-align:center;}
.green{color:#00ff99;}
.red{color:#ff4d4d;}
.yellow{color:#ffcc00;}
.gray{color:#aaa;}
.big{font-size:20px;font-weight:bold;}
.bar{height:8px;background:#222;border-radius:5px;overflow:hidden;margin-top:5px;}
.fill{height:100%;background:linear-gradient(90deg,#ff4d4d,#ffcc00,#00ff99);width:0%;}
.small{font-size:12px;color:#aaa;margin-top:5px;}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;}
.log{background:#0a0e14;padding:8px;border-radius:6px;font-family:monospace;font-size:11px;height:100px;overflow-y:auto;color:#0ff;}
</style>
</head>
<body>

<div class="card">
<h2>üîí LOCK STRUCTURE (1x per H1)</h2>
H1 High <input type="number" id="h1h">
H1 Low <input type="number" id="h1l">
M30 High <input type="number" id="m30h">
M30 Low <input type="number" id="m30l">
M15 High <input type="number" id="m15h">
M15 Low <input type="number" id="m15l">
<button onclick="lockLevels()" id="lockBtn">LOCK STRUCTURE</button>
<div id="lockInfo" class="small"></div>
</div>

<div class="card">
<h2>üè¶ H2 / H4 FILTER</h2>
H4 High <input type="number" id="h4h">
H4 Low <input type="number" id="h4l">
H2 High <input type="number" id="h2h">
H2 Low <input type="number" id="h2l">
<button onclick="setInstitutional()">SET FILTER</button>
<div id="institutionInfo" class="small"></div>
</div>

<div class="card">
<h2>üì• M5 MEMORY (12 SLOT)</h2>
<div class="grid">
<input type="number" id="m5_1" placeholder="1">
<input type="number" id="m5_2" placeholder="2">
<input type="number" id="m5_3" placeholder="3">
<input type="number" id="m5_4" placeholder="4">
<input type="number" id="m5_5" placeholder="5">
<input type="number" id="m5_6" placeholder="6">
<input type="number" id="m5_7" placeholder="7">
<input type="number" id="m5_8" placeholder="8">
<input type="number" id="m5_9" placeholder="9">
<input type="number" id="m5_10" placeholder="10">
<input type="number" id="m5_11" placeholder="11">
<input type="number" id="m5_12" placeholder="12">
</div>
<button onclick="processEngine()">PROCESS ENGINE</button>
<div class="small">Isi sesuai urutan close candle. Telat input aman.</div>
</div>

<div class="card">
<h2>üìä ENGINE STATUS</h2>
<div id="h1Status" class="status gray">H1: WAIT</div>
<div id="m30Status" class="status gray">M30: WAIT</div>
<div id="m15Status" class="status gray">M15: WAIT</div>
<div id="m5Status" class="status gray">M5: WAIT</div>
<div id="flowStatus" class="status gray">FLOW: -</div>
<div id="pressureStatus" class="status gray">PRESSURE: 0</div>
<div id="finalStatus" class="status big gray">FINAL: -</div>
<div class="bar"><div id="confidenceBar" class="fill"></div></div>
</div>

<div class="card">
<h2>üõ° RISK ENGINE</h2>
RR <input type="number" id="rrInput" value="2" step="0.1">
<div id="entry" class="small"></div>
<div id="sl" class="small"></div>
<div id="tp" class="small"></div>
</div>

<div class="card">
<h2>üß† INSTITUTIONAL ASSISTANT</h2>
<div id="assistant" class="small"></div>
</div>

<div class="card">
<h2>üìù GOLDEN LOG</h2>
<div id="log" class="log"></div>
</div>

<script>

let levels=null;
let institutional=null;
let lockedHour=null;
let logData=[];

function lockLevels(){

let now=new Date().getHours();
if(lockedHour===now){
lockInfo.innerText="Sudah lock periode ini.";
return;
}

levels={
H1:{high:parseFloat(h1h.value),low:parseFloat(h1l.value)},
M30:{high:parseFloat(m30h.value),low:parseFloat(m30l.value)},
M15:{high:parseFloat(m15h.value),low:parseFloat(m15l.value)}
};

if(Object.values(levels).some(tf=>isNaN(tf.high)||isNaN(tf.low))){
alert("Isi level valid.");
return;
}

lockedHour=now;
lockInfo.innerText="Structure locked jam "+now+":00";
}

function setInstitutional(){
institutional={
H4:{high:parseFloat(h4h.value),low:parseFloat(h4l.value)},
H2:{high:parseFloat(h2h.value),low:parseFloat(h2l.value)}
};
institutionInfo.innerText="Filter aktif.";
}

function getM5Array(){
let arr=[];
for(let i=1;i<=12;i++){
let val=parseFloat(document.getElementById("m5_"+i).value);
if(!isNaN(val))arr.push(val);
}
return arr;
}

function tfSignal(tf,m5){
if(m5.length<2)return "WAIT";
let high=levels[tf].high;
let low=levels[tf].low;
let last=m5[m5.length-1];
let prev=m5[m5.length-2];
if(prev>high && last>high)return "BUY";
if(prev<low && last<low)return "SELL";
return "WAIT";
}

function m5Signal(m5){
if(m5.length<2)return "WAIT";
let last=m5[m5.length-1];
let prev=m5[m5.length-2];
if(last>prev)return "BUY";
if(last<prev)return "SELL";
return "WAIT";
}

function pressure(m5){
let high=levels.M15.high;
let low=levels.M15.low;
let side=null,count=0;
for(let i=m5.length-1;i>=0;i--){
let p=m5[i];
if(p>high){
if(side==="SELL")break;
side="BUY";count++;
}
else if(p<low){
if(side==="BUY")break;
side="SELL";count++;
}
else break;
}
return count;
}

function flow(m5){
if(m5.length<5)return "NEUTRAL";
let up=0,down=0;
for(let i=m5.length-4;i<m5.length;i++){
if(m5[i]>m5[i-1])up++;
else if(m5[i]<m5[i-1])down++;
}
if(up>=4)return "STRONG_BUY";
if(down>=4)return "STRONG_SELL";
return "NEUTRAL";
}

function institutionalCheck(price){
if(!institutional)return "Filter tidak aktif.";
let msg=[];
let range=institutional.H4.high-institutional.H4.low;
if(price>institutional.H4.high)msg.push("üö® Above H4 High");
else if(price>institutional.H4.high-range*0.1)msg.push("‚ö† Near H4 High");
if(price<institutional.H4.low)msg.push("üö® Below H4 Low");
else if(price<institutional.H4.low+range*0.1)msg.push("‚ö† Near H4 Low");
if(msg.length===0)msg.push("Structure Safe");
return msg.join(" ¬∑ ");
}

function processEngine(){

if(!levels)return;

let m5=getM5Array();
if(m5.length<2)return;

let price=m5[m5.length-1];

let h1=tfSignal("H1",m5);
let m30=tfSignal("M30",m5);
let m15=tfSignal("M15",m5);
let m5s=m5Signal(m5);
let press=pressure(m5);
let flowSig=flow(m5);

h1Status.innerText="H1: "+h1;
m30Status.innerText="M30: "+m30;
m15Status.innerText="M15: "+m15;
m5Status.innerText="M5: "+m5s;
flowStatus.innerText="FLOW: "+flowSig;
pressureStatus.innerText="PRESSURE: "+press;

let score=0;
score+=h1==="BUY"?4:h1==="SELL"?-4:0;
score+=m30==="BUY"?3:m30==="SELL"?-3:0;
score+=m15==="BUY"?2:m15==="SELL"?-2:0;
score+=m5s==="BUY"?1:m5s==="SELL"?-1:0;
score+=flowSig==="STRONG_BUY"?2:flowSig==="STRONG_SELL"?-2:0;
score+=press;

let final="NETRAL";
if(score>=10)final="üöÄ GOLDEN BUY";
if(score<=-10)final="üöÄ GOLDEN SELL";
else if(score>=6)final="üî• DOMINASI BUY";
else if(score<=-6)final="üî• DOMINASI SELL";

finalStatus.innerText="FINAL: "+final;
confidenceBar.style.width=Math.min(100,Math.abs(score)*5)+"%";

assistant.innerText=institutionalCheck(price);

// Risk
let rr=parseFloat(rrInput.value)||2;

if(score>=6){
let slv=levels.M15.low;
let risk=price-slv;
entry.innerText="ENTRY: "+price;
sl.innerText="SL: "+slv;
tp.innerText="TP: "+(price+risk*rr);
}
else if(score<=-6){
let slv=levels.M15.high;
let risk=slv-price;
entry.innerText="ENTRY: "+price;
sl.innerText="SL: "+slv;
tp.innerText="TP: "+(price-risk*rr);
}
else{
entry.innerText="ENTRY: -";
sl.innerText="SL: -";
tp.innerText="TP: -";
}

if(final.includes("GOLDEN")){
let now=new Date().toLocaleTimeString();
logData.unshift(now+" "+final+" @"+price);
if(logData.length>20)logData.pop();
document.getElementById("log").innerText=logData.join("\n");
}
}

</script>
</body>
</html>
